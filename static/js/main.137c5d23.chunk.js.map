{"version":3,"sources":["components/Trip.js","helpers.js","components/App.js","registerServiceWorker.js","index.js"],"names":["Trip","stations","this","props","d","Date","time","hour","replace","ignoreStations","filteredStations","filter","st","indexOf","station","t","split","map","i","Number","done","getHours","getMinutes","react_default","a","createElement","className","concat","key","React","PureComponent","pad0","n","getTime","date","join","getISODate","getUTCFullYear","getUTCMonth","getUTCDate","getPeriodFromDates","dates","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","da","value","_map","start","end","reverse","_map2","Object","slicedToArray","s1","s2","_map3","s","construct","toConsumableArray","_map4","d1","d2","type","err","return","App","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","data","store","get","state","campus","period","nextCampus","bind","assertThisInitialized","nextPeriod","updateTime","_this2","fetch","then","res","json","set","setState","campi","length","periods","_this$state","trips","str","myTrips","myCampus","onClick","style","lineHeight","charAt","toUpperCase","slice","id","lib","svg","text","trip","components_Trip","Component","isLocalhost","Boolean","window","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","error","ReactDOM","render","src_components_App","document","getElementById","URL","process","origin","addEventListener","response","status","headers","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.137c5d23.chunk.js","sourcesContent":["import React from 'react';\n\nclass Trip extends React.PureComponent {\n  render() {\n    const { stations } = this.props;\n    const d = new Date(2019, 1, 18, 16, 20, 20); // TODO: fix this\n\n    const time = stations[0].hour.replace(/\\./g, ':');\n\n    const ignoreStations = ['Praça de Londres', 'Sete-Rios'];\n    const filteredStations = stations.filter(st => ignoreStations.indexOf(st.station) === -1);\n\n    const t = time.split(':').map(i => Number(i));\n    const done = d.getHours() > t[0] || (d.getHours() === t[0] && d.getMinutes() >= t[1]);\n\n    return (\n      <div className={`card${done ? ' done' : ''}`}>\n        {\n          //<h3>{stations[0].station} ⟶ {stations[stations.length - 1].station}</h3>}\n        }\n        {filteredStations.map((st, i) => (\n          <span key={i} className={'entry'}>\n            <strong>{st.hour.replace(/\\./g, ':')}</strong> {st.station}\n          </span>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default Trip;\n","export function pad0(n) {  // padding with 0\n  return n > 9 ? n : '0' + n;\n}\n\nexport function getTime(date) {\n  const d = date || new Date();\n  return [d.getHours(), d.getMinutes()].map(pad0).join(':');\n}\n\nexport function getISODate(date) {\n  const d = date || new Date();\n  return [d.getUTCFullYear(), d.getUTCMonth() + 1, d.getUTCDate()].map(pad0).join('-');\n}\n\nexport function capitalize(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n","import React from 'react';\nimport store from 'store';\nimport { Twemoji } from 'react-emoji-render';\nimport Trip from './Trip';\nimport './App.css';\nimport { capitalize, getTime, getISODate } from '../helpers';\n\nconst URL = 'https://web.tecnico.ulisboa.pt/~ist178013/api/shuttle/';\n\nfunction getPeriodFromDates(dates) {\n  const date = new Date();\n\n  for (const da of dates) {\n    const [s1, s2] = [da.start, da.end].map(d => d.split('/').reverse().map(d => Number(d)));\n    s1[1]--;\n    s2[1]--;\n    const [d1, d2] = [s1, s2].map(s => new Date(...s));\n    if (date >= d1 && date <= d2) return da.type;\n  }\n\n  return 'weekend';\n}\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    const data = store.get('data');\n\n    this.state = {\n      date: getISODate(),\n      time: getTime(),\n      campus: 'Taguspark',\n      period: 'weekday', //getPeriod(), // day of week\n      data: data || undefined,\n    };\n\n    this.nextCampus = this.nextCampus.bind(this);\n    this.nextPeriod = this.nextPeriod.bind(this);\n    this.updateTime = this.updateTime.bind(this);\n  }\n\n  componentDidMount() {\n    const { data } = this.state;\n\n    if (data === undefined) {\n      fetch(URL)\n        .then((res) => res.json())\n        .then((data) => {\n          store.set('data', data);\n          this.setState({ data, period: getPeriodFromDates(data.date) });\n        });\n    } else {\n      this.setState({ period: getPeriodFromDates(data.date) });\n    }\n  }\n\n  nextCampus() {\n    const { campus } = this.state;\n    const campi = ['Taguspark', 'Alameda'];\n    const i = ((campi.indexOf(campus) || 0) + 1) % campi.length;\n\n    this.setState({ campus: campi[i] });\n  }\n\n  nextPeriod() {\n    const { period } = this.state;\n    const periods = ['weekday', 'holidays', 'exams'];\n    const i = ((periods.indexOf(period) || 0) + 1) % periods.length;\n\n    this.setState({ period: periods[i] });\n  }\n\n  updateTime() {\n    this.setState({ time: getTime() });\n  }\n\n  render() {\n    const { data, time, campus, period } = this.state;\n    if (!data) return null;\n\n    const { trips } = data;\n    if (!trips) return null;\n\n    const myTrips = trips.filter(t => t.type === period && t.stations[0].station === campus);\n    const myCampus = (campus === 'Taguspark') ? 'Taguspark\\nAlameda' : 'Alameda\\nTaguspark';\n\n    return (\n      <main>\n        <header>\n          <h3>\n            <div className={'right'}>\n              <span onClick={this.updateTime} style={{ lineHeight: '3rem' }}>{time}</span>\n            </div>\n            <div className={'table'}>\n              <span className={'block'} onClick={this.nextPeriod}>{capitalize(period)}</span>\n              <span className={'big'}>⇄</span>\n              <span className={'block'} onClick={this.nextCampus}>{myCampus}</span>\n            </div>\n          </h3>\n        </header>\n        <section id=\"infos\" className={'table'}>\n          {(period === 'weekend')\n            ? (<div className={'card'}>\n              <div>Today is weekend!</div>\n              <div><Twemoji svg text={'There is no Shuttle ❌ 🚌 😢'} /></div>\n            </div>)\n            : myTrips.map((trip, i) => (<Trip key={i} stations={trip.stations} />))}\n        </section>\n      </main>\n    );\n  }\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n"],"sourceRoot":""}